<!DOCTYPE html>
<html lang="en">

<head>
    <title>Polycubes</title>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/style.css" >
    <link rel="stylesheet" href="css/toggle_switch.css" >
    <script type="module" src="./build/index.js"></script>
</head>
<body >
    <div id="examples" class="modal" onclick="toggleModal(this.id)">
        <div class="modal-content">
            <h3>Examples</h3>
            <a href="?hexRule=040000000000840000000000">Dimer</a>,
            <a href="?hexRule=040087000000">Square</a>,
            <a href="?hexRule=040803000000888403000000">Linear chain</a>,
            <a href="?hexRule=05050a08000085858a880000">2D plane (checkerboard)</a>,
            <a href="?hexRule=00040008000c840088008c00">Cube</a>,
            <a href="?hexRule=0406008800008400140000008c0800000000901400000000980c171710129c1a0000000094000000000016141c000000">Robot</a>,
            <a href="?hexRule=00000006008b00008600000c000000028c00080c0c000c0c048600000000">Giraffe-duck</a>,
            <a href="?hexRule=980e1b0c0c1b020c0c01008d">64-mer</a>,
            <a href="?hexRule=070000008900080100008500">Helix</a>,
            <a href="?hexRule=860000000000040000898f0000090600000f">Star</a>
            <a href="?hexRule=000084000a0f00000500008e000000001113880000000090">Tetrahedron</a>

            <h3>What is a polycube?</h3>
            "A polycube is a solid figure formedivd by joining one or more equal cubes face to face" - <a href="https://en.wikipedia.org/wiki/Polycube">Wikipedia</a>

            <h3>Ok, but what is this model about?</h3>
            An output polycube is generated by stochastically assembling it from an input set of building block cubes.
            Each cube can have up to six patches (one at each side) and the patches will bind together if they have complementary colours and
            the same orientation.

            <h3>So what do I do?</h3>
            Change the input by adding, removing, or modifying the available cube types. You can change the patch colours by changing the
            corresponding numbers. Positive numbers will bind to negative: 1 to -1, 2 to -2, etc. An empty patch has the value 0 and will not bind.
            You can also change the patch orientations by clicking the <img alt="face" src="ui/face.svg" style="vertical-align: middle;" height="35"> button.
        </div>
    </div>
    <div id="info">
        Polycubes, by Joakim Bohlin and Josh Evans. A 3D version of <a href="http://chaoticsymmetry.co.uk/polyominoes/index-old.php">Polyominoes</a><br>
        <button class="primary" onclick="toggleModal('examples')">Help</button>
        <button onclick="system.resetRandom(); clearRules(); update();">Random input</button>
        <button onclick="system.resetRule(parseHexRule(mutateRule(system.getRuleStr()))); clearRules(); update();">Mutate input</button>
        <!--        <button onclick="simplifyRule(); update();">Simplify</button>-->
        <!--        <button onclick="simplifyRule2(); update();">Simplify2</button>-->
        <!--         <button onclick="toggleConsole($(this));">Show Console</button> -->
        <button onclick="reduce(); $().empty(); system.cube_types.forEach(addSpecies); update();">Reduce</button>
        <button id="envToggle">Show Environment</button>
        <fieldset id="inputs">
            <legend>Input:</legend>
            <div id="ruleset" style="overflow: hidden"></div>
            <button class="primary" id="addSpeciesBtn">Add cube type</button>
            <span style="display: flex;">
                    <button id="reseedRandomBtn">Update</button>
                    <input type="checkbox" id="autoUpdate" checked="checked" onchange="update();">Auto update
                </span>
            <label class="switch" style="display: none;">
                Staged Assembly
                <input type="checkbox" id="stagedAssemblyToggle">
                <span class="slider round"></span>
            </label>
        </fieldset>
        <span style="display: flex;">
            <!--<div>
                <label for="assemblyMode">Assembly Mode:</label>
                <select id="assemblyMode" onchange="system.resetAssemblyMode(this.value); render();">
                    <option value="stochastic" selected>Stochastic</option>
                    <option value="seeded">Seeded</option>
                    <<		            <option value="ordered">Ordered</option>
                </select>
            </div>-->
            <img src="ui/download.svg"
                 id="downloadstructure"
                 class="control_button"
                 height="30"
                 style="margin: 1% 1% 1% 1%;"
                 alt="Download structure" />
            <input type="file"
                   accept="json"
                   style="display:none;"
                   id="uploadrules">
            <img id="uploadrulebtn"
                 class="control_button"
                 height="30"
                 src="ui/download.svg"
                 style="margin: 1% 1% 1% 1%; transform: rotate(180deg);"
                 alt="Upload rule" />
    <!-- 			<input type="file" accept="json" onchange="uploadRules();" class="control_button" height="30" src="ui/download.svg" style="transform: rotate(180deg);"/> -->
        </span>
        <span style="display: flex;">
            <label for="pieceSize">Piece Size:</label>
            <input id="pieceSize" type="number" min="1" value="3"/>
            <input type="file" accept="json" style="display:none;" id="uploadsys">
            <img style="display: flex;"
                 id="uploadstructurebtn"
                 src="ui/upload_scene.svg"
                 class="control_button"
                 height="30"
                 alt="Upload structure">
        </span>
        <span style="display: flex;">
                    <input type="checkbox" id="torsion" checked /><label for="torsion">Torsion</label><br>
                    <!--<img style="display: flex;"
                         src="ui/patch.svg"
                         class="control_button"
                         height="30"
                         onclick="$('#patchy-export-panel').toggle();"
                         alt=""/>-->
            <!--	        	<img style="display: flex;" src="ui/download_graph.svg" class="control_button" height="30" onclick="download_topology();">-->
            <!--	        	<img style="display: flex;" src="ui/download_graph.svg" class="control_button" height="30" onclick="$('#graphui').toggle();">-->
                    <img style="display: flex;"
                         src="ui/show_rule.svg"
                         class="control_button"
                         height="30"
                         id="toggle-rule"
                         alt="Show rule visualization">
                </span>
        <input type="checkbox" id="mismatches" checked /><label for="mismatches">Mismatches?</label>
        <span id="mismatch_count_field">
            Mismatch Count: <span id="mismatchcount"></span>
        </span>
        <button id="toggle-fog">Toggle fog</button>
        <button id="toggle-lineview">Toggle line view</button>
        <button id="hideToggle" onclick="toggleRuleSet()">Hide</button>
        <!--https://stackoverflow.com/a/19965480 location.search-->
    </div>
    <div id="stepcontrols">
        <div id="stepcount">Step: </div>
        <img id="reset"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/reset.svg"
             alt="Rebuild polycube"/>
        <img id="back"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/stepfwd.svg"
             alt="Go back one step"/>
        <img id="pause"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/pause.svg"
             alt="pause"/>
        <img id="stepfwd"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/stepfwd.svg"
             alt="go forward one step"/>
        <img id="play"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/play.svg"
             alt="continue simulation"/>
        <img id="ff"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/ff.svg"
             alt="fast forward"/>
        <img id="fff"
             class="stepctrlbtn control_button"
             height="30"
             src="ui/fff.svg"
             alt="fast-fast-forward"/>
        <span style="display: inline-block; margin: auto 0 auto 0;">Advance To:</span>
        <input type="number" id="stepto" min="0" value="100">
    </div>
    <div id="env-browser" >

    </div>
    <div id="display-rule-panel">
        <svg id="rule-display-canvas" width="900px" style="overflow:visible;"></svg>
    </div>
   <!-- <div id="graphui">
        <div id="cy"></div>
    </div>-->
    <canvas id="threeCanvas"></canvas>
    </body>
</html>